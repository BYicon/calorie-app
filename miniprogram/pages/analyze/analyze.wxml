<navigation-bar title="åˆ†æ" back="{{false}}"></navigation-bar>
<!-- ä¸»è¦å†…å®¹ -->
<view class="main-content">
  <!-- å‘¨æœŸé€‰æ‹©å™¨ -->
  <view class="period-selector">
    <button class="{{period === 'day' ? 'active' : ''}}" bindtap="changePeriod" data-period="day">æ—¥</button>
    <button class="{{period === 'week' ? 'active' : ''}}" bindtap="changePeriod" data-period="week">å‘¨</button>
    <button class="{{period === 'month' ? 'active' : ''}}" bindtap="changePeriod" data-period="month">æœˆ</button>
    <button class="{{period === 'year' ? 'active' : ''}}" bindtap="changePeriod" data-period="year">å¹´</button>
  </view>
  
  <!-- çƒ­é‡æ‘„å…¥è¶‹åŠ¿å›¾è¡¨ -->
  <view class="chart-container">
    <view class="chart-header">
      <!-- <view class="chart-title">
        <text class="icon">ğŸ“ˆ</text>
        <text>çƒ­é‡æ‘„å…¥è¶‹åŠ¿</text>
      </view> -->
      <!-- æ·»åŠ å½“å‰æ˜¾ç¤ºçš„æ—¶é—´èŒƒå›´ -->
      <view class="chart-date">{{currentDateRange}}</view>
    </view>
    
    <view class="chart {{period === 'year' ? 'year' : ''}}">
      <view class="limit-line"></view>
      <view class="limit-label">ç›®æ ‡ {{calorieGoal}}å¡</view>
      
      <!-- ä½¿ç”¨swiperå®ç°å·¦å³æ»‘åŠ¨ -->
      <swiper class="chart-swiper" bindchange="onSwiperChange" current="{{currentSwiperIndex}}">
        <swiper-item wx:for="{{chartDataList}}" wx:key="index">
          <view class="chart-bars">
            <view wx:for="{{item.data}}" wx:key="index" wx:for-item="barItem" class="chart-bar {{barItem.value > calorieGoal ? 'over-limit' : ''}}" style="height: {{barItem.height}};">
              <view class="chart-bar-value">{{barItem.value}}</view>
              <view class="chart-bar-label">{{barItem.label}}</view>
            </view>
          </view>
        </swiper-item>
      </swiper>
    </view>
  </view>
  
  <!-- ç»Ÿè®¡æ•°æ® -->
  <view class="stats-grid">
    <view class="stat-card">
      <view class="value">{{stats.avgCalories}}</view>
      <view class="label">å¹³å‡æ¯æ—¥æ‘„å…¥ (å¡)</view>
    </view>
    <view class="stat-card">
      <view class="value">{{stats.overLimitDays}}</view>
      <view class="label">è¶…æ ‡å¤©æ•°</view>
    </view>
    <view class="stat-card">
      <view class="value">{{stats.maxCalories}}</view>
      <view class="label">æœ€é«˜æ‘„å…¥ (å¡)</view>
    </view>
    <view class="stat-card">
      <view class="value">{{stats.minCalories}}</view>
      <view class="label">æœ€ä½æ‘„å…¥ (å¡)</view>
    </view>
  </view>
  
  <!-- æ™ºèƒ½åˆ†æ -->
  <view class="analysis-card">
    <view class="card-title">
      <text class="icon">ğŸ’¡</text>
      <text>æ™ºèƒ½åˆ†æ</text>
    </view>
    <view class="card-content">
      <text>{{analysis.insight}}</text>
    </view>
  </view>
  
  <!-- å»ºè®® -->
  <view class="analysis-card">
    <view class="card-title">
      <text class="icon">ğŸ¥—</text>
      <text>å»ºè®®</text>
    </view>
    <view class="card-content">
      <text>{{analysis.suggestion}}</text>
    </view>
  </view>
</view> 