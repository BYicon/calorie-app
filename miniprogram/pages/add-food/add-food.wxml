<!-- 头部 -->
<navigation-bar title="添加食物" back="{{true}}"></navigation-bar>

<!-- 主要内容 -->
<view class="main-content">
  <!-- 餐食选择器 -->
  <view class="meal-selector">
    <button class="{{selectedMeal === 'breakfast' ? 'active' : ''}}" bindtap="selectMeal" data-meal="breakfast">早餐</button>
    <button class="{{selectedMeal === 'lunch' ? 'active' : ''}}" bindtap="selectMeal" data-meal="lunch">午餐</button>
    <button class="{{selectedMeal === 'dinner' ? 'active' : ''}}" bindtap="selectMeal" data-meal="dinner">晚餐</button>
    <button class="{{selectedMeal === 'snacks' ? 'active' : ''}}" bindtap="selectMeal" data-meal="snacks">零食</button>
  </view>
  
  <form bindsubmit="saveFood">
    <!-- 食物名称 -->
    <view class="form-group">
      <view class="label">食物名称</view>
      <input type="text" name="foodName" placeholder="例如：鸡胸肉沙拉" value="{{foodInfo.name}}"/>
    </view>
    
    <!-- 选择食物图标 -->
    <view class="form-group">
      <view class="label">选择食物图标</view>
      <view class="emoji-selector">
        <view wx:for="{{emojiOptions}}" wx:key="index"
              class="emoji-option {{selectedEmoji === item ? 'selected' : ''}}"
              bindtap="selectEmoji" data-emoji="{{item}}">
          {{item}}
        </view>
      </view>
    </view>
    
    <!-- 卡路里 -->
    <view class="form-group">
      <view class="label">卡路里</view>
      <view class="nutrient-input">
        <input type="digit" name="calories" placeholder="350" value="{{foodInfo.calories}}"/>
        <text class="nutrient-unit">卡</text>
      </view>
    </view>
    
    <!-- 份量 -->
    <view class="form-group">
      <view class="label">份量</view>
      <view class="serving-input">
        <input type="digit" name="servingAmount" placeholder="1" value="{{foodInfo.servingAmount}}"/>
        <picker bindchange="onServingUnitChange" value="{{servingUnitIndex}}" range="{{servingUnits}}">
          <view class="serving-unit-picker">
            {{servingUnits[servingUnitIndex]}}
          </view>
        </picker>
      </view>
    </view>
    
    <!-- 营养成分 -->
    <view class="form-group">
      <view class="label">营养成分 (可选)</view>
      <view class="nutrient-inputs">
        <view class="nutrient-input">
          <input type="digit" name="carbs" placeholder="碳水" value="{{foodInfo.carbs}}"/>
          <text class="nutrient-unit">g</text>
        </view>
        <view class="nutrient-input">
          <input type="digit" name="protein" placeholder="蛋白质" value="{{foodInfo.protein}}"/>
          <text class="nutrient-unit">g</text>
        </view>
        <view class="nutrient-input">
          <input type="digit" name="fat" placeholder="脂肪" value="{{foodInfo.fat}}"/>
          <text class="nutrient-unit">g</text>
        </view>
        <view class="nutrient-input">
          <input type="digit" name="fiber" placeholder="纤维" value="{{foodInfo.fiber}}"/>
          <text class="nutrient-unit">g</text>
        </view>
      </view>
    </view>
    
    <!-- 日期 -->
    <view class="form-group">
      <view class="label">日期</view>
      <picker mode="date" value="{{selectedDate}}" bindchange="onDateChange">
        <view class="date-picker">
          {{selectedDate}}
        </view>
      </picker>
    </view>
    
    <!-- 提交按钮 -->
    <button formType="submit" class="submit-btn">保存食物</button>
    
    <!-- 提示 -->
    <view class="note">
      不知道卡路里信息？
      <text class="link" bindtap="goToSearch">查询食物</text>
      或
      <text class="link" bindtap="goToAiSearch">询问AI</text>
    </view>
  </form>
</view> 